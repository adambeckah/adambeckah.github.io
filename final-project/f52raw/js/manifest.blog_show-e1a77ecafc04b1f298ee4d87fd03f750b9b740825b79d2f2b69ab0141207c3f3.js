"undefined"==typeof f52&&(f52={}),"undefined"==typeof f52.ko&&(f52.ko={}),f52.ko.bannerTrigger=function(){$(document).on("click","#find-friends-cta .dismiss",function(e){e.preventDefault(),f52.ctas.findFriends.dismiss()}),$(document).on("click","#signup-next-cta .dismiss",function(e){e.preventDefault(),f52.ctas.followInfluencers.dismiss()});var e={showFF:f52.ctas.findFriends.show,showCollect:f52.ctas.followInfluencers.show};f52.kovm.addToViewModel("bannerTrigger",e)}(),function(){function e(e,t){var o="Promo Banner",n=window.location.pathname;return void 0!==typeof t?ga("send","event",o,e,n,"",t):ga("send","event",o,e,n,"")}f52.base.setHeaderOffsetOnClick($(".article-meta").find("a[href*=#]").not(".js-toggle-recipe-block-body")),f52.base.setHeaderOffsetOnClick($(".article-content").find("a[href*=#]").not(".js-toggle-recipe-block-body")),$(document).ready(function(){var t={224:"brimfield",225:"cakeparade",256:"bestweek",229:"piglet2017"};$("img.lazy-img").lazyload(),$(".js-editors-post-body").on("click","a",function(e){this.href.split("/")[2]!=document.location.href.split("/")[2]&&(e.preventDefault(),window.open($(this).attr("href")))}),$(".js-hide-extra-button").click(function(){$(this).parents(".story-recipe").children(".story-recipe-header").find(".collapsed-action-button").toggle()}),$(".tweet-quote").on("click",function(e){e.preventDefault(),e.stopPropagation(),ga("send","social","Twitter","Pull Quote Tweet",document.URL),ga("send","event",{eventCategory:"Social Shares",eventAction:"Twitter Shares",eventLabel:document.URL,eventValue:0}),f52.eventLog.social_share_intent({path:document.URL,channel:"twitter"}),window.open(this.href,"","width=600, height=320")}),$(".js-promo-banner-shown").length>0&&(ga("send","event","Promo Banner","Marketing Promo Banner Shown",window.location.pathname,"",{nonInteraction:1}),_.each(t,function(t,o){var n="."+t;if($(n)[0]){var l=t.charAt(0).toUpperCase()+t.slice(1);e(l+" Promo Banner Shown",{nonInteraction:1})}})),$(".js-promo-banner-shown").on("click",function(o){ga("send","event","Promo Banner","Marketing Promo Banner Clicked",window.location.pathname),_.each(t,function(t,n){var l=$(o.target).attr("class").split(" "),a=-1!=l.indexOf(t);a&&e(t+" promo banner clicked")})}),$(".js-book-promo-footer").on("click","a",function(){$(this).closest(".js-book-promo-footer").data("book");ga("send","event","Promo Banner","Book Promo Banner Clicked",window.location.pathname)});var o=$(".js-article-actions").data("sticky-min-width");if($(window).width()>=o){var n=$("#global-header-block"),l=n.data("global-nav-height");if(n.hasClass("-promo-banner-present"))var a=$(".global-promo-banner").height(),s=a+l;else var s=l;$(".js-article-actions").stick_in_parent({parent:".js-sticky-actions-container",offset_top:s+30})}$(window).width()>=620&&$(".js-sticky-article-sidebar").stick_in_parent({parent:".article-body",spacer:"js-spacer"})})}(),function(){var e=f52.datautils.ago,t=f52.datautils.observableArrayInsortNoDupe,o=f52.datautils.arraySortedFind;ko.bindingHandlers.focusVisible={update:function(e,t,o){var n=t(),l=(o(),ko.utils.unwrapObservable(n));1==l?$(e).show().find("textarea").focus():$(e).hide()}};var n=function s(t,o,n){var l={};return l.id=parseInt(t.id||"0"),l.tmpId=t.tmpId||0,l.parentId=null===t.parentId?null:parseInt(t.parentId),l.userId=parseInt(t.userId),l.user=o[t.userId],l.body=ko.observable(t.body),l.createdAt=new Date(t.createdAt),l.showReplyForm=ko.observable(!1),l.replyCommentText=ko.observable(""),l.childComments=ko.observableArray(ko.utils.arrayMap(t.childComments,function(e){return s(e,o,n)})),l.pending=l.tmpId>0,l.displayTime=ko.computed(function(){return l.pending?"just now":e(n(),l.createdAt)}),l},l=function(e,t,o){var l=function(e){return n(e,t,o)};return ko.utils.arrayMap(e,l)},a=function(e){var a={},s={};return ko.utils.arrayForEach(e.commentingUsers,function(e){s[e.id]=e}),a.currentUser=f52.ko.base.observableCurrentUser,ko.computed(function(){a.currentUser()&&(s[a.currentUser().id]=a.currentUser())}),a.commentableType=e.commentableType,a.commentableId=e.commentableId,a.observableNow=ko.observable(new Date),a.comments=ko.observableArray(l(e.comments,s,a.observableNow)),a.totalCommentsCount=ko.observable(e.totalComments),a.newCommentText=ko.observable(""),a.wants_emails=ko.observable(!0),a.loadedCommentsCount=ko.computed(function(){var e=0;return ko.utils.arrayForEach(a.comments(),function(t){e=e+1+t.childComments().length}),e}),a.latestCommentId=ko.observable(function(){var e=0;return ko.utils.arrayForEach(a.comments(),function(t){t.id>e&&(e=t.id),ko.utils.arrayForEach(t.childComments(),function(t){t.id>e&&(e=t.id)})}),e}()),a.loadingMoar=ko.observable(!1),a.loadMoarBtnText=ko.computed(function(){return a.loadingMoar()?"Loading&hellip;":"Load More"}),a.loadingLatest=ko.observable(!1),a.loadLatestBtnText=ko.computed(function(){return a.loadingLatest()?"Checking for new comments&hellip;":'<span class="f52-icon">&#xeb82;</span> Check for new comments'}),a.removeTmpComment=function(e){if(null===e.parentId)a.comments.remove(function(t){return t.tmpId===e.tmpId});else{var t=a.comments(),n=o(t,{id:e.parentId},function(e){return e.id},function(e,t){return e>t}),l=t[n];l.childComments.remove(function(t){return t.tmpId===e.tmpId})}},a.findComment=function(e){var t=a.comments(),o=_.find(t,function(t){return t.id==e});return o},a.addComment=function(e){var o=$.extend({id:null,parentId:null,parentComment:null,userId:a.currentUser().id,body:"",createdAt:new Date,childComments:[],commentingUsers:[]},e);ko.utils.arrayForEach(o.commentingUsers,function(e){s[e.id]=e}),null===o.id&&(o.tmpId=(new Date).getTime(),o.id=a.latestCommentId()+o.tmpId),o.parentComment&&(o.parentId=o.parentComment.id);var l=n(o,s,a.observableNow);return null!==o.parentComment?o.parentComment.childComments.push(l):null!==o.parentId?ko.utils.arrayForEach(a.comments(),function(e){e.id===o.parentId&&t(e.childComments,l,function(e){return e.id})}):t(a.comments,l,function(e){return e.id},function(e,t){return e>t}),a.observableNow(new Date),null!==l.id&&0===l.tmpId&&l.id>a.latestCommentId()&&a.latestCommentId(l.id),l},a.addTopLevelComments=function(e,t){ko.utils.arrayForEach(t,function(e){s[e.id]=e});var o=l(e,s,a.observableNow);a.comments([].concat.apply(a.comments(),o))},a};f52.setupComments=function(e){$("#server_side_comments").hide(),$("#client_side_comments").show();var t=a(e);f52.ko.loginSystem.registerUserCustomizations("comment_email_status",{commentableType:t.commentableType,commentableId:t.commentableId},function(e){null!==e&&t.wants_emails(e.wantsEmails)}),f52.kovm.addToViewModel("comments",t),setInterval(function(){t.observableNow(new Date)},1e4);var o=function(e,o){$.post("/comments/ajax_add_comment",{latest_comment_id:t.latestCommentId(),commentable_type:t.commentableType,commentable_id:t.commentableId,body:e.body,parent_id:e.parentId,wants_emails:o},function(o){t.removeTmpComment(e),o.modMessage?f52.flash.flashNotice(o.modMessage):(t.totalCommentsCount(o.totalComments),ko.utils.arrayForEach(o.comments,function(e){t.addComment({id:e.id,userId:e.userId,parentId:e.parentId,body:e.body,createdAt:e.createdAt,commentingUsers:o.commentingUsers})})),t.observableNow(new Date),f52.eventLog.create_comment({obj_type:f52.datautils.toUnderscore(t.commentableType),obj_id:t.commentableId,comment_id:o.newCommentId,parent_id:e.parentId})})},n=function(){window.optimizely.push(["trackEvent","added a comment"])},l=f52.ko.loginSystem.setupLoggedInAction("comments","addComment",function(e,l){var a=t.addComment({body:l.text});t.newCommentText(""),o(a,l.wants_emails),t.wants_emails(l.wants_emails),e&&f52.flash.flashNotice("Successfully added comment"),n()}),s=f52.ko.loginSystem.setupLoggedInAction("comments","replyComment",function(e,l){console.log(l);var a=t.findComment(l.parentId),s=l.text;t.wants_emails(l.wants_emails);var i=t.addComment({body:s,parentComment:a});a.replyCommentText(""),a.showReplyForm(!1),o(i,t.wants_emails()),e&&f52.flash.flashNotice("Succesfully added reply."),n()});$("#client_side_comments").on("click",".add_new_comment_btn",function(e){e.preventDefault();var o=t.newCommentText();o.length>0&&l({text:o,wants_emails:t.wants_emails()})}),$("#client_side_comments").on("click",".reply_toggle",function(e){e.preventDefault();var t=ko.contextFor(this),o=t.$parents[t.$parents.length-3];o.showReplyForm(!o.showReplyForm())}),$("#client_side_comments").on("click",".reply_comment_btn",function(e){e.preventDefault();var o=ko.contextFor(this),n=o.$data,l=n.replyCommentText();l.length>0&&s({parentId:n.id,text:l,wants_emails:t.wants_emails()})}),$("#client_side_comments").on("click",".moar_comments_btn",function(e){if(e.preventDefault(),!$(this).hasClass("disabled")){var o="/comments/moar_comments?commentable_type="+t.commentableType+"&commentable_id="+t.commentableId+"&offset="+t.comments().length;t.loadingMoar(!0),$.getJSON(o,function(e){t.loadingMoar(!1),t.totalCommentsCount(e.totalComments),t.addTopLevelComments(e.comments,e.commentingUsers)})}});var i=function(e){if(!t.loadingLatest()){var o="/comments/comments_since?commentable_type="+t.commentableType+"&commentable_id="+t.commentableId+"&latest_comment_id="+t.latestCommentId();t.loadingLatest(!0),$.getJSON(o,function(o){t.loadingLatest(!1),t.totalCommentsCount(o.totalComments),ko.utils.arrayForEach(o.comments,function(e){t.addComment({id:e.id,userId:e.userId,parentId:e.parentId,body:e.body,createdAt:e.createdAt,commentingUsers:o.commentingUsers})}),t.observableNow(new Date),"undefined"!=typeof e&&e(o.comments.length)})}},c=null,r=2,d=!0,u=r,f=function p(){null!==c&&(clearTimeout(c),c=null),i(function(e){e>0?u=r:u-=1,u>0&&(c=setTimeout(p,5e3))})};if(d){var m=!0;ko.computed(function(){var e=f52.ko.base;m&&!e.observablePendingLoginCheck()&&e.observableCurrentUser()&&(m=!1,f())})}$(".load_latest_comments_btn").click(function(e){e.preventDefault(),$(this).hasClass("disabled")||f()})}}(),"undefined"==typeof f52&&(f52={}),"undefined"==typeof f52.ko&&(f52.ko={}),f52.ko.collections=function(){function e(){var e={};e.userCollections=ko.observableArray(),e.userCollectionAssociations=ko.observableArray(),e.modal=ko.observable(null),e.showModal=function(t){var o={widget:t,name:t.name,image:t.image,cmsBlock:t.cmsBlock,collectableType:t.collectableType,collectableId:t.collectableId};ko.computed(function(){_.each(t.userCollections(),function(e){e.stableSaved=e.saved(),e.stableLastUsed=e.lastUsed()})}),o.filteredCollections=ko.computed(function(){return _.chain(t.userCollections()).sortBy(function(e){return e.isDefault?"a":"z"}).rest().value()}),o.chronUserCollections=ko.computed(function(){return _.sortBy(o.filteredCollections(),function(e){return-e.stableLastUsed})});var n=5;o.recentCollections=ko.computed(function(){var t=o.chronUserCollections(),l=_.find(t,function(t){return t.stableLastUsed<e.serverOneWeekAgo}),a=_.indexOf(t,l),s=_.min([a,n]),i=_.first(t,s);return _.sortBy(i,function(e){return e.stableSaved?"a":"z"})}),o.nonrecentCollections=ko.computed(function(){var e=_.difference(o.chronUserCollections(),o.recentCollections());return _.sortBy(e,function(e){return[e.stableSaved?"a":"z",e.lname].join(" ")})}),o.showRecentHeadings=ko.computed(function(){return o.filteredCollections().length>n&&o.recentCollections().length>0&&o.nonrecentCollections().length>0});var l=e.modal();l&&l.widget.expanded(!1),e.modal(o),o.widget.expanded(!0)},e.addCollection=f52.ko.loginSystem.setupLoggedInAction("collections","addCollection",function(t,l){var a=l.title,s=l.collectableType,i=l.collectableId,c=l.cmsBlock,r=$.trim(a.toLowerCase());if(r.length>o)return f52.flash.flashError("Collection titles can't be longer than "+o+" characters."),void e.closeModal();if("favorites"===r)return f52.flash.flashError("Oops! Want to favorite this? Try using the heart button."),void e.closeModal();var d=_.any(e.userCollections(),function(e){return e.lname===r});return d?(f52.flash.flashError("Collection '"+a+"' already exists."),void e.closeModal()):void $.post("/collections/ajax_add_collection",{title:a}).done(function(o){n(o.collectionId,s,i,c);var l=e.serverNow+100;e.serverNow=l,e.userCollections.push({id:o.collectionId,name:a,lastUsed:ko.observable(l)}),setTimeout(function(){e.closeModal()},500),t&&f52.flash.flashNotice("Succesfully created "+a)}).fail(function(e){0!==e.status&&f52.flash.flashError("Unexpected error creating collection.")})}),e.closeModal=function(){var t=e.modal();t&&(t.widget.expanded(!1),e.modal(null))},e.modalShowing=function(){return null!==e.modal()},e.collectableWidgets=[],e.collectableIds=[];var t=function(){return!1},l=function(o,n,l,a,s,i,c){var r={};return r.expanded=ko.observable(!1),i?(r.saveCtaShowing=f52.ctas.save.show,r.faveCtaShowing=f52.ctas.fave.show):(r.saveCtaShowing=t,r.faveCtaShowing=t),r.collectableType=o,r.collectableId=n,r.saveCount=ko.observable(l),r.name=ko.observable(a),r.image=ko.observable(s),r.cmsBlock=c,r.userCollections=ko.computed(function(){return _.map(e.userCollections(),function(t){return{id:t.id,name:t.name,isDefault:t.isDefault,lastUsed:t.lastUsed,lname:t.name.toLowerCase(),saved:ko.computed(function(){var o=e.userCollectionAssociations();return _.any(o,function(e){var o=e[0],l=e[1],a=e[2];return r.collectableType===l&&n===a&&t.id===o})})}})}),r.userSavedAny=ko.computed(function(){return _.any(r.userCollections(),function(e){return e.saved()&&!e.isDefault})}),r.userFaved=ko.computed(function(){var e=r.userCollections();return e.length>0&&e[0].saved()}),r},a=function(e,t,o){return o?"collectionWidget"+e+t+o:"collectionWidget"+e+t},s=!0;return $(".collection-widget").each(function(){var t=$(this),o=parseInt(t.attr("data-collectable-id")),n=t.attr("data-collectable-type"),i=parseInt(t.attr("data-collectable-num-faved")),c=t.attr("data-collectable-name"),r=t.attr("data-collectable-image"),d="1"===t.attr("data-include-cta"),u=_.isEmpty(t.attr("data-cms-block"))?null:t.attr("data-cms-block"),f=a(n,o,u);e.collectableIds.push([n,o,u]);var m=l(n,o,i,c,r,d&&s,u);s=!1,e.collectableWidgets.push(m),e[f]=m}),e.lookupWidget=function(t,o,n){var l=a(t,o,n),s=e[l];return s||alert("couldn't find widget for "+l),s},e.initUser=function(t){f52.hashParams.checkParams({serverNow:1423752375,serverOneWeekAgo:1423147596,userCollections:[{name:"My Collection",id:22,isDefault:!1,lastUsed:1423674520551}],userCollectionAssociations:[[]]},t),e.serverNow=t.serverNow,e.serverOneWeekAgo=t.serverOneWeekAgo,e.userCollections(_.map(t.userCollections,function(e){return e.lastUsed=ko.observable(e.lastUsed),e})),e.userCollectionAssociations(t.userCollectionAssociations)},e.clearUser=function(){e.currentUserId=null,e.userCollections([]),e.userCollectionAssociations([]),e.closeModal()},e.userSavedAny=function(){return _.any(e.collectableWidgets,function(e){return e.userSavedAny()})},$(document).click(function(t){e.modalShowing()&&(e.closeModal(),t.preventDefault())}),$(document).bind("keydown",function(t){27==t.keyCode&&null!==e.modal()&&(e.closeModal(),t.preventDefault())}),$("#collection-modal").on("click",".collection-list",function(e){e.stopPropagation()}),function(){var t=0;$(window).resize(_.throttle(function(){var o=$(window),n=o.width(),l=n!==t;t=n,l&&e.closeModal()},1e3))}(),e}var t={collectionWidgets:e()};f52.ko.loginSystem.registerUserCustomizations("collections",{collectableIdsOnPage:t.collectionWidgets.collectableIds},function(e){e?t.collectionWidgets.initUser(e):t.collectionWidgets.clearUser()}),f52.kovm.addToViewModel("collections",t);var o=f52.inputs.base.collectionTitleMaxLen;ko.bindingHandlers.collectionModal={init:function(e,t,o,n){var l=t(),a=$(e);ko.computed(function(){var e=l();if(null!==e){a.removeClass("show-modal");var t=e.widget,o=["collection-widget",t.collectableType,""+t.collectableId,t.cmsBlock].join("-");_.defer(function(){var t=$("#"+o).find(".js-save-btn"),n=a.find(".collection-list"),l=n.outerWidth(),s=t.offset(),i=s.top,c=s.left,r=t.outerHeight(),d=t.outerWidth(),u=c+d,f=i+r,m=$(window).width(),p=u-l,v=p>=0?p:c;v+l>m&&(v=m-l-10),n.css({top:f+10,left:v}),a.addClass("show-modal"),0==e.filteredCollections().length&&a.find(".footer input").focus()})}else a.removeClass("show-modal")})}};var n=function(e,o,n,l){var a=t.collectionWidgets,s=a.userCollections()[0].id,i=a.lookupWidget(o,n,l);a.userCollectionAssociations.push([e,o,n,l]);var c=!1;if(s===e){var c=!0;i.saveCount(i.saveCount()+1)}$.post("/collections/"+e+"/ajax_widget_add_collectable",{collectable_type:i.collectableType,collectable_id:n}).done(function(t){var l;switch(i.collectableType){case"recipe":l=c?"Recipe Favorite":"Recipe Saves";break;case"post":l=c?"Blog Favorite":"Blog Saves";break;case"product_sku":l=c?"Product Favorite":"Product Saves"}ga("send","event","User Engagement",l,window.location.pathname),f52.eventLog.save_content({obj_type:o,obj_id:n,coll_id:e,default_coll:c}),i.saveCount(t.numCollectionsSaved);var s=a.serverNow+100;a.serverNow=s,_.find(a.userCollections(),function(t){return t.id===e}).lastUsed(s)}).fail(function(e){0!==e.status&&f52.flash.flashError("Unexpected error saving collectable to collection.")})},l=function(e,o,n,l){var a=t.collectionWidgets,s=a.userCollections()[0].id,i=a.lookupWidget(o,n,l);a.userCollectionAssociations.remove(function(t){var l=t[0],a=t[1],s=t[2];return o===a&&e===l&&n===s}),s===e&&i.saveCount(i.saveCount()-1),$.post("/collections/"+e+"/ajax_widget_remove_collectable",{collectable_type:o,collectable_id:n}).done(function(e){}).fail(function(e){0!==e.status&&f52.flash.flashError("Unexpected error removing collectable from collection.")})},a=f52.ko.loginSystem.setupLoggedInAction("collections","faveCollectable",function(e,o){f52.hashParams.checkParams({collectableType:"recipe",collectableId:44,cmsBlock:"content_item",faved:!0},o);var a=t.collectionWidgets,s=a.userCollections()[0].id,i=a.lookupWidget(o.collectableType,o.collectableId,o.cmsBlock);o.faved&&!i.userFaved()?n(s,o.collectableType,o.collectableId,o.cmsBlock):!o.faved&&i.userFaved()&&l(s,o.collectableType,o.collectableId,o.cmsBlock),e&&f52.flash.flashNotice("Successfully added to favorites")});$("#global-page-frame").on("click",".collection-widget .js-save-btn",function(e){e.preventDefault(),e.stopPropagation();var t=ko.contextFor(this),o=t.$data,n=t.$parent;return o.faveCtaShowing()&&f52.ctas.fave.dismiss(),o.saveCtaShowing()&&f52.ctas.save.dismiss(),n.modalShowing()&&n.modal().widget===o?void n.closeModal():void n.showModal(o)}),$("#global-page-frame").on("click",".collection-widget .js-fav-btn",function(e){e.preventDefault(),e.stopPropagation();var t=ko.contextFor(this),o=t.$data,n=(t.$parent,!o.userFaved());o.faveCtaShowing()&&f52.ctas.fave.dismiss(),o.saveCtaShowing()&&f52.ctas.save.dismiss(),a({collectableType:o.collectableType,collectableId:o.collectableId,cmsBlock:o.cmsBlock,faved:n})}),$("#collection-modal").on("click",".toggle-collection",function(e){e.preventDefault();var t=ko.contextFor(this),o=t.$data,a=t.$parent,s=a.widget,i=t.$parentContext.$parent,c=!o.saved(),r=o.id,d=s.collectableId;c?(n(r,s.collectableType,d,s.cmsBlock),window.optimizely.push(["trackEvent","saved to a collection"])):l(r,s.collectableType,d,s.cmsBlock),i.modalShowing()&&setTimeout(function(){i.closeModal()},250)}),$("#global-page-frame").on("click",".collection-widget .save-ux-helper .modal-bg",function(e){e.preventDefault(),e.stopPropagation();var t=ko.contextFor(this),o=t.$data;o.faveCtaShowing()&&f52.ctas.fave.dismiss(),o.saveCtaShowing()&&f52.ctas.save.dismiss()}),$(document).bind("keydown",function(e){27==e.keyCode&&(f52.ctas.fave.show()&&(f52.ctas.fave.dismiss(),e.preventDefault()),f52.ctas.save.show()&&(f52.ctas.save.dismiss(),e.preventDefault()))}),$("#global-page-frame").on("click",".collection-widget .save-ux-helper .btn",function(e){e.preventDefault(),e.stopPropagation();var t=ko.contextFor(this),o=t.$data;$popup=$($(this).closest(".save-ux-helper")),$ctaShowing=$($popup.siblings(".cta-showing")),o.faveCtaShowing()&&($ctaShowing.removeClass("cta-showing"),$popup.addClass("save-ux-helper--dismissed"),f52.ctas.fave.dismiss()),o.saveCtaShowing()&&($ctaShowing.removeClass("cta-showing"),$popup.addClass("save-ux-helper--dismissed"),f52.ctas.save.dismiss())}),$("#collection-modal").on("click",".faux-input",function(){$(this).addClass("focused")}),$("#collection-modal").on("submit","form",function(e){e.preventDefault();var o=ko.contextFor(this),n=o.$data,l=t.collectionWidgets,a=$(this).find("input"),s=$.trim(a.val());s.length>0&&(a.val("").blur(),l.addCollection({title:s,collectableType:n.collectableType,collectableId:n.collectableId,cmsBlock:n.cmsBlock}))}),$("#collection-modal").on("click",".empty-room a",function(e){e.preventDefault();var o=$(this).find("span.name").text(),n=ko.contextFor(this),l=n.$data,a=t.collectionWidgets;a.addCollection({title:o,collectableType:l.collectableType,collectableId:l.collectableId})})}(),"undefined"==typeof f52&&(f52={}),"undefined"==typeof f52.ko&&(f52.ko={}),f52.ko.userFollowing=function(){var e={followedUserIds:ko.observableArray(),pending:ko.observable(!1),currentUserId:ko.observable()},t=[],o=function(t){var o=_.difference(t,e.followedUserIds());o.length>0&&e.followedUserIds(_.union(e.followedUserIds(),o))},n=function(e){return"followButton"+e},l=function(t,o,l){var a={userId:ko.observable(t),followed:ko.computed(function(){return _.include(e.followedUserIds(),t)}),isSelf:ko.computed(function(){return t===e.currentUserId()}),source:o};_.isUndefined(l)||(a.callback=l);var s=n(t);return e[s]=a,a};$(".user-follow-button").each(function(){var e=$(this),o=e.attr("data-user-id"),n=parseInt(o),a=e.attr("data-follow-source");t.push(n),l(n,a)});var a=f52.inputs.base.followUserPathTemplate,s=f52.ko.loginSystem.setupLoggedInAction("user_following","toggleFollow",function(t,o){var l=o.userId,s=o.newFollowStatus,i=a.replace("0",String(l)),c=e[n(l)];l===e.currentUserId()&&f52.flash.flashNotice("Oops! You tried to follow yourself.");var r=s!=c.followed();e.pending()||(r?(e.pending(!0),$.post(i,{id:l,source:c.source},function(o){o.success&&(o.followed?(e.followedUserIds.push(l),t&&f52.flash.flashNotice("Successfully followed user.")):e.followedUserIds.remove(l),t||f52.ko.feed.refreshFeed()),e.pending(!1),_.isUndefined(c.callback)||c.callback()}).fail(function(){f52.flash.flashError("An unexpected error occurred while trying to follow this user.")})):f52.flash.flashNotice("You already follow this user."))});return $(document).on("click",".user-follow-button",function(e){e.preventDefault();var t=ko.dataFor(this),o=t.userId(),n=!t.followed();s({userId:o,newFollowStatus:n})}),f52.ko.loginSystem.registerUserCustomizations("user_following",{userIds:t},function(t){null!==t?(e.followedUserIds(t.followedUserIds),e.currentUserId(t.currentUserId)):(e.followedUserIds([]),e.currentUserId(null))}),f52.kovm.addToViewModel("userFollowing",e),{addFollowedUserIds:o,setupFollowButton:l}}(),"undefined"==typeof f52&&(f52={}),"undefined"==typeof f52.ko&&(f52.ko={}),f52.ko.signupNext=function(){var e={showing:ko.observable(!1),tasteMakers:ko.observableArray([])},t=function(){window.optimizely.push(["trackEvent","followed via signup_next modal"])};f52.ko.loginSystem.registerUserCustomizations("signup_next",{},function(o){if(null!==o){var n=_.chain(o.tasteMakers).filter(function(e){return e.followed}).map(function(e){return e.id}).value();f52.ko.userFollowing.addFollowedUserIds(n),_.each(o.tasteMakers,function(e){e.followButton=f52.ko.userFollowing.setupFollowButton(e.id,"signup_next_tastemakers",t)}),e.tasteMakers(o.tasteMakers)}else e.tasteMakers([])});var o=function(e,t){var o=Math.abs(e)<Math.abs(t)?e:t;return Math.max(0,o)},n=function(){var e=$("#signup-next-modal"),t=($(window).height()-e.height())/2,n=.2*($(window).height()-e.height());t=o(t,n),e.css("top",t+$(document).scrollTop())},l=f52.ko.loginSystem.setupLoggedInAction("signups","showSignupNextModal",function(t,o){e.showing(!0),n()});return $(document).ready(function(){$(document).on("click",".after-signup",function(e){e.preventDefault(),l({})}),$(document).bind("keydown.email-modal",function(t){27===t.keyCode&&e.showing()&&(t.preventDefault(),e.showing(!1))}),$("#signup-next-wrapper").on("click",".modal-bg",function(){e.showing(!1)}),$("#signup-next-wrapper").on("click","a.dismiss",function(t){t.preventDefault(),e.showing(!1)})}),f52.kovm.addToViewModel("signupNext",e),{showSignupNextModal:l}}(),function(){var e,t;e=this.jQuery||window.jQuery,t=e(window),e.fn.stick_in_parent=function(o){var n,l,a,s,i,c,r,d,u,f,m;for(null==o&&(o={}),m=o.sticky_class,i=o.inner_scrolling,f=o.recalc_every,u=o.parent,d=o.offset_top,r=o.spacer,l=o.bottoming,null==d&&(d=0),null==u&&(u=void 0),null==i&&(i=!0),null==m&&(m="is_stuck"),n=e(document),null==l&&(l=!0),a=function(o,a,s,c,p,v,h,g){var b,w,k,y,C,_,I,$,x,U,S,T;if(!o.data("sticky_kit")){if(o.data("sticky_kit",!0),C=n.height(),I=o.parent(),null!=u&&(I=I.closest(u)),!I.length)throw"failed to find stick parent";if(b=k=!1,(S=null!=r?r&&o.closest(r):e("<div />"))&&S.css("position",o.css("position")),$=function(){var e,t,l;return!g&&(C=n.height(),e=parseInt(I.css("border-top-width"),10),t=parseInt(I.css("padding-top"),10),a=parseInt(I.css("padding-bottom"),10),s=I.offset().top+e+t,c=I.height(),k&&(b=k=!1,null==r&&(o.insertAfter(S),S.detach()),o.css({position:"",top:"",width:"",bottom:""}).removeClass(m),l=!0),p=o.offset().top-(parseInt(o.css("margin-top"),10)||0)-d,v=o.outerHeight(!0),h=o.css("float"),S&&S.css({width:o.outerWidth(!0),height:v,display:o.css("display"),"vertical-align":o.css("vertical-align"),"float":h}),l)?T():void 0},$(),v!==c)return y=void 0,_=d,U=f,T=function(){var e,u,w,x;return!g&&(w=!1,null!=U&&(--U,0>=U&&(U=f,$(),w=!0)),w||n.height()===C||$(),w=t.scrollTop(),null!=y&&(u=w-y),y=w,k?(l&&(x=w+v+_>c+s,b&&!x&&(b=!1,o.css({position:"fixed",bottom:"",top:_}).trigger("sticky_kit:unbottom"))),p>w&&(k=!1,_=d,null==r&&("left"!==h&&"right"!==h||o.insertAfter(S),S.detach()),e={position:"",width:"",top:""},o.css(e).removeClass(m).trigger("sticky_kit:unstick")),i&&(e=t.height(),v+d>e&&!b&&(_-=u,_=Math.max(e-v,_),_=Math.min(d,_),k&&o.css({top:_+"px"})))):w>p&&(k=!0,e={position:"fixed",top:_},e.width="border-box"===o.css("box-sizing")?o.outerWidth()+"px":o.width()+"px",o.css(e).addClass(m),null==r&&(o.after(S),"left"!==h&&"right"!==h||S.append(o)),o.trigger("sticky_kit:stick")),k&&l&&(null==x&&(x=w+v+_>c+s),!b&&x))?(b=!0,"static"===I.css("position")&&I.css({position:"relative"}),o.css({position:"absolute",bottom:a,top:"auto"}).trigger("sticky_kit:bottom")):void 0},x=function(){return $(),T()},w=function(){return g=!0,t.off("touchmove",T),t.off("scroll",T),t.off("resize",x),e(document.body).off("sticky_kit:recalc",x),o.off("sticky_kit:detach",w),o.removeData("sticky_kit"),o.css({position:"",bottom:"",top:"",width:""}),I.position("position",""),k?(null==r&&("left"!==h&&"right"!==h||o.insertAfter(S),S.remove()),o.removeClass(m)):void 0},t.on("touchmove",T),t.on("scroll",T),t.on("resize",x),e(document.body).on("sticky_kit:recalc",x),o.on("sticky_kit:detach",w),setTimeout(T,0)}},s=0,c=this.length;c>s;s++)o=this[s],a(e(o));return this}}.call(this),$(document).ready(function(){var e=$(".js-toggle-recipe-block-body");_.isEmpty(e)||e.on("click",function(e){e.preventDefault();var t=$(this).data("blockid");$(".story-recipe-body[data-blockid='"+t+"']").slideToggle(),$(this).text("Show More"==$(this).text()?"Show Less":"Show More")})}),"undefined"==typeof f52&&(f52={}),"undefined"==typeof f52.ko&&(f52.ko={}),f52.ko.blogShow=function(){var e=f52.inputs.blogShow,t={customCollectionsHtml:ko.observable()};f52.ko.loginSystem.registerUserCustomizations("blog_show",{id:e.postId},function(e){null!==e?t.customCollectionsHtml(e.customCollectionsHtml):t.customCollectionsHtml(null)}),f52.kovm.addToViewModel("blogShow",t)}();